{"remainingRequest":"E:\\lanze\\lanzeyigou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\lanze\\lanzeyigou\\src\\components\\Chat.1.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\lanze\\lanzeyigou\\src\\components\\Chat.1.vue","mtime":1568788174130},{"path":"E:\\lanze\\lanzeyigou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568767580909},{"path":"E:\\lanze\\lanzeyigou\\node_modules\\babel-loader\\lib\\index.js","mtime":1568767579596},{"path":"E:\\lanze\\lanzeyigou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568767580909},{"path":"E:\\lanze\\lanzeyigou\\node_modules\\vue-loader\\lib\\index.js","mtime":1568767606597}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tmsg: \"\",\n\t\t\tuid: \"\",\n\t\t\tsummsg: []\n\t\t}\n\t},\n\tmethods: {\n\t\tsendmsg() {\n\t\t\tvar token = localStorage.getItem(\"token\");\n\t\t\tif (token) {\n\t\t\t\tthis.axios\n\t\t\t\t\t.get(\"/Chat\", {\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\truid: this.uid,\n\t\t\t\t\t\t\ttoken,\n\t\t\t\t\t\t\ttype: \"add\",\n\t\t\t\t\t\t\tmessage: this.msg\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\tconsole.log(\"发送的聊天消息\", result);\n\n\t\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tgetsendmsg() {\n\t\t\tvar time = 5000;\n\t\t\tsetInterval(() => {\n\t\t\t\tconsole.log(\"请求一次\");\n\t\t\t\tvar token = localStorage.getItem(\"token\");\n\t\t\t\tif (token) {\n\t\t\t\t\tthis.axios\n\t\t\t\t\t\t.get(\"/Chat\", {\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\ttoken,\n\t\t\t\t\t\t\t\ttype: \"get\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\t\tconsole.log(\"收到的聊天消息\", result);\n\t\t\t\t\t\t\tvar status = result.data.status;\n\t\t\t\t\t\t\tif (status == 1) {\n\t\t\t\t\t\t\t\tvar msg = result.data.data;\n\t\t\t\t\t\t\t\tif (msg) {\n\t\t\t\t\t\t\t\t\tthis.summsg = msg.reduce(\n\t\t\t\t\t\t\t\t\t\t(prev, elem) => {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(JSON.parse(elem.message));\n\t\t\t\t\t\t\t\t\t\t\tvar mymsg=JSON.parse(elem.message);\n\t\t\t\t\t\t\t\t\t\t\tif (prev[mymsg.suid] === undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid] = [[]];\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0]=[];\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1]=[]\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\"user\":\"you\",\"msg\":mymsg.message})\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\n\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\"user\":\"you\",\"msg\":mymsg.message})\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\treturn prev;\n\t\t\t\t\t\t\t\t\t\t}, {}\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tconsole.log(this.summsg, \"###############################################\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar count = result.data.count;\n\t\t\t\t\t\t\t\tif (count == 0 && time >= 5000) {\n\t\t\t\t\t\t\t\t\ttime += (time < 10000) ? 500 : 0;\n\t\t\t\t\t\t\t\t\tif (time == 10000) {\n\t\t\t\t\t\t\t\t\t\ttime = 5000;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconsole.log(\"##################11111\", time)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttime = 5000;\n\t\t\t\t\t\t\t\t\tconsole.log(\"##################\", time)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}, 10000)\n\t\t}\n\t},\n\tcreated() {\n\t\t// this.getsendmsg()\n\t}\n}\n",{"version":3,"sources":["Chat.1.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Chat.1.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<hr>\r\n\t\t<input v-model=\"uid\" type=\"text\">\r\n\t\t<hr>\r\n\t\t<input v-model=\"msg\" type=\"text\">\r\n\t\t<hr>\r\n\t\t<button @click=\"sendmsg()\">发送</button>\r\n\t</div>\r\n</template>\r\n<script>\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tmsg: \"\",\r\n\t\t\t\tuid: \"\",\r\n\t\t\t\tsummsg: []\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsendmsg() {\r\n\t\t\t\tvar token = localStorage.getItem(\"token\");\r\n\t\t\t\tif (token) {\r\n\t\t\t\t\tthis.axios\r\n\t\t\t\t\t\t.get(\"/Chat\", {\r\n\t\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t\truid: this.uid,\r\n\t\t\t\t\t\t\t\ttoken,\r\n\t\t\t\t\t\t\t\ttype: \"add\",\r\n\t\t\t\t\t\t\t\tmessage: this.msg\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).then(result => {\r\n\t\t\t\t\t\t\tconsole.log(\"发送的聊天消息\", result);\r\n\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetsendmsg() {\r\n\t\t\t\tvar time = 5000;\r\n\t\t\t\tsetInterval(() => {\r\n\t\t\t\t\tconsole.log(\"请求一次\");\r\n\t\t\t\t\tvar token = localStorage.getItem(\"token\");\r\n\t\t\t\t\tif (token) {\r\n\t\t\t\t\t\tthis.axios\r\n\t\t\t\t\t\t\t.get(\"/Chat\", {\r\n\t\t\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\t\t\ttoken,\r\n\t\t\t\t\t\t\t\t\ttype: \"get\"\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).then(result => {\r\n\t\t\t\t\t\t\t\tconsole.log(\"收到的聊天消息\", result);\r\n\t\t\t\t\t\t\t\tvar status = result.data.status;\r\n\t\t\t\t\t\t\t\tif (status == 1) {\r\n\t\t\t\t\t\t\t\t\tvar msg = result.data.data;\r\n\t\t\t\t\t\t\t\t\tif (msg) {\r\n\t\t\t\t\t\t\t\t\t\tthis.summsg = msg.reduce(\r\n\t\t\t\t\t\t\t\t\t\t\t(prev, elem) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(JSON.parse(elem.message));\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar mymsg=JSON.parse(elem.message);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (prev[mymsg.suid] === undefined) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid] = [[]];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0]=[];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1]=[]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\"user\":\"you\",\"msg\":mymsg.message})\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\"user\":\"you\",\"msg\":mymsg.message})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn prev;\r\n\t\t\t\t\t\t\t\t\t\t\t}, {}\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(this.summsg, \"###############################################\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvar count = result.data.count;\r\n\t\t\t\t\t\t\t\t\tif (count == 0 && time >= 5000) {\r\n\t\t\t\t\t\t\t\t\t\ttime += (time < 10000) ? 500 : 0;\r\n\t\t\t\t\t\t\t\t\t\tif (time == 10000) {\r\n\t\t\t\t\t\t\t\t\t\t\ttime = 5000;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"##################11111\", time)\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\ttime = 5000;\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"##################\", time)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 10000)\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// this.getsendmsg()\r\n\t\t}\r\n\t}\r\n</script>\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}