{"remainingRequest":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\src\\components\\Chat.vue?vue&type=template&id=2bc3d388&","dependencies":[{"path":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\src\\components\\Chat.vue","mtime":1568880651951},{"path":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568767580909},{"path":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\node_modules\\vue-loader\\lib\\loaders\\templateLoader.js","mtime":1568767606603},{"path":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1568767580909},{"path":"C:\\Users\\simplett\\Desktop\\小组作业\\新建文件夹 (4)\\lanzeyigou\\node_modules\\vue-loader\\lib\\index.js","mtime":1568767606597}],"contextDependencies":[],"result":["\n\t<div>\n\t\t<div class=\"content-title\">\n\t\t\t<div>\n\t\t\t\t<img src=\"../../public/images/usercenter/shoucang.png\" alt=\"\">\n\t\t\t\t<p>收藏</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"content-b\">\n\t\t\t<el-container>\n\t\t\t\t<!-- 侧边栏 -->\n\t\t\t\t<el-aside>\n\t\t\t\t\t<!-- 姓名 -->\n\t\t\t\t\t<div class=\"chat-a\">\n\t\t\t\t\t\t<p>丁小瑞</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- 聊天列表 -->\n\t\t\t\t\t<!-- <div class=\"chat-list-a\">\n\n\t\t\t\t\t</div> -->\n\t\t\t\t\t<div class=\"chat-list\">\n\t\t\t\t\t\t<!-- 聊天朋友列表 -->\n\t\t\t\t\t\t<div @click=\"Tomsg(item[2])\" v-for=\"(item,i) of summsg\" :key=\"i\">\n\t\t\t\t\t\t\t<peoplelist :time=\"totime\" :msg=\"tomsg\" :uid=\"item[2]\"></peoplelist>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t</div>\n\t\t\t\t</el-aside>\n\t\t\t\t<el-main>\n\t\t\t\t\t<!-- 信息框 -->\n\t\t\t\t\t<div class=\"chat-b\">\n\t\t\t\t\t\t<p>小螺号</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"chat-msg\">\n\t\t\t\t\t\t<component v-for=\"(item,index) in summsg[msguser][0]\" :key=\"index\" :is=\"summsg[msguser][1][index].user\" :info=\"summsg[msguser][1][index].msg\"\n\t\t\t\t\t\t :time=\"item\"></component>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"msg-input\">\n\t\t\t\t\t\t<input class=\"m-input\" v-model=\"sendmsg\" @click=\"sendmsg()\" type=\"text\">\n\t\t\t\t\t\t<a href=\"javascript:;\" class=\"btn btn-success\" @click=\"sendmsg()>发送</a>\n\t\t\t\t\t</div>\n\t\t\t\t</el-main>\n\t\t\t</el-container>\n\t\t</div>\n\t</div>\n</template>\n<script>\n\timport you from \"./chat/say_a.vue\"\n\timport me from \"./chat/say_b.vue\"\n\timport peoplelist from \"./chat/peoplelist.vue\"\n\n\texport default {\n\t\tcomponents: {\n\t\t\tpeoplelist,\n\t\t\tme,\n\t\t\tyou\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tsendmsg: \"\",\n\t\t\t\tmsguser: \"00\",\n\t\t\t\ttotime: \"\",\n\t\t\t\ttomsg: \"\",\n\t\t\t\tmsg: \"\",\n\t\t\t\tuid: \"\",\n\t\t\t\tsummsg: {\n\t\t\t\t\t\"00\": [\n\t\t\t\t\t\t[\"2019-05-45\"],\n\t\t\t\t\t\t[{\n\t\t\t\t\t\t\t\"user\": \"me\",\n\t\t\t\t\t\t\t\"msg\": \"616516311111111111111111111111111111111111111111111111111111111\"\n\t\t\t\t\t\t}], \"00\"\n\t\t\t\t\t],\n\t\t\t\t\t\"22\": [\n\t\t\t\t\t\t[\"2019-05-45\", \"123131\"],\n\t\t\t\t\t\t[{\n\t\t\t\t\t\t\t\t\"user\": \"you\",\n\t\t\t\t\t\t\t\t\"msg\": \"61651631\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"user\": \"you\",\n\t\t\t\t\t\t\t\t\"msg\": \"61651631\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t], \"22\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tsendmsgs() {\n\t\t\t\tif (this.summsg[this.uid] == undefined) {\n\t\t\t\t\tthis.summsg[this.uid] = [\n\t\t\t\t\t\t[]\n\t\t\t\t\t];\n\t\t\t\t\t// console.log(\"@@@@@@@@@@@@@@@@@@@@@@@@@\", item[0], item[1], item[2], item);\n\t\t\t\t\tthis.summsg[this.uid][0] = [];\n\t\t\t\t\t// console.log(\"&&&&&&&&&&&&&&&&&&&&&\", summessage[this.uid][0]);\n\t\t\t\t\tthis.summsg[this.uid][1] = [];\n\t\t\t\t\tthis.summsg[this.uid][2] = '';\n\t\t\t\t\tthis.summsg[this.uid][0].push(\"111111\");\n\t\t\t\t\tthis.summsg[this.uid][1].push({\n\t\t\t\t\t\t\"user\": \"me\",\n\t\t\t\t\t\t\"msg\": this.sendmsg\n\t\t\t\t\t});\n\t\t\t\t\tthis.summsg[this.uid][2] = this.uid;\n\t\t\t\t} else {\n\t\t\t\t\tthis.summsg[this.uid][0].push(\"111111\");\n\t\t\t\t\tthis.summsg[this.uid][1].push({\n\t\t\t\t\t\t\"user\": \"me\",\n\t\t\t\t\t\t\"msg\": this.sendmsg\n\t\t\t\t\t});\n\t\t\t\t\tthis.summsg[this.uid][2] = this.uid;\n\t\t\t\t}\n\n\t\t\t\tvar token = localStorage.getItem(\"token\");\n\t\t\t\tif (token) {\n\t\t\t\t\tthis.axios\n\t\t\t\t\t\t.get(\"/Chat\", {\n\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\truid: this.uid,\n\t\t\t\t\t\t\t\ttoken,\n\t\t\t\t\t\t\t\ttype: \"add\",\n\t\t\t\t\t\t\t\tmessage: this.msg\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\t\tconsole.log(\"发送的聊天消息\", result);\n\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\tTomsg(uid) {\n\t\t\t\tthis.msguser = uid;\n\t\t\t\tthis.uid = uid;\n\t\t\t\tconsole.log(uid);\n\t\t\t},\n\t\t\tgetsendmsg() {\n\t\t\t\tvar time = 5000;\n\t\t\t\tsetInterval(() => {\n\t\t\t\t\tconsole.log(\"请求一次\");\n\t\t\t\t\tvar token = localStorage.getItem(\"token\");\n\t\t\t\t\tif (token) {\n\t\t\t\t\t\tthis.axios\n\t\t\t\t\t\t\t.get(\"/Chat\", {\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\ttoken,\n\t\t\t\t\t\t\t\t\ttype: \"get\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).then(result => {\n\t\t\t\t\t\t\t\tconsole.log(\"收到的聊天消息\", result);\n\t\t\t\t\t\t\t\tvar status = result.data.status;\n\t\t\t\t\t\t\t\tif (status == 1) {\n\t\t\t\t\t\t\t\t\tvar msg = result.data.data;\n\t\t\t\t\t\t\t\t\tvar summessage = {};\n\t\t\t\t\t\t\t\t\tif (msg) {\n\t\t\t\t\t\t\t\t\t\tsummessage = msg.reduce(\n\t\t\t\t\t\t\t\t\t\t\t(prev, elem) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(JSON.parse(elem.message));\n\t\t\t\t\t\t\t\t\t\t\t\tvar mymsg = JSON.parse(elem.message);\n\t\t\t\t\t\t\t\t\t\t\t\tif (prev[mymsg.suid] === undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid] = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0] = [];\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1] = [];\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][2] = '';\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"user\": \"you\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"msg\": mymsg.message\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][2] = mymsg.suid;\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.totime = prev[mymsg.suid][0][(prev[mymsg.suid][0]).length - 1].substr(11, 8);\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.tomsg = prev[mymsg.suid][1][(prev[mymsg.suid][1]).length - 1][msg];\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][0].unshift(mymsg.time);\n\t\t\t\t\t\t\t\t\t\t\t\t\tprev[mymsg.suid][1].unshift({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"user\": \"you\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"msg\": mymsg.message\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.totime = prev[mymsg.suid][0][(prev[mymsg.suid][0]).length - 1].substr(11, 8);\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.tomsg = prev[mymsg.suid][1][(prev[mymsg.suid][1]).length - 1].msg;\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(this.tomsg);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\treturn prev;\n\t\t\t\t\t\t\t\t\t\t\t}, {}\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"########################这是数据\", summessage)\n\t\t\t\t\t\t\t\t\t\tfor (var item in summessage) {\n\t\t\t\t\t\t\t\t\t\t\tif (this.summsg[item] == undefined) {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item] = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t[]\n\t\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"@@@@@@@@@@@@@@@@@@@@@@@@@\", item[0], item[1], item[2], item);\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][0] = [];\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"&&&&&&&&&&&&&&&&&&&&&\", summessage[item][0]);\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][1] = [];\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][2] = '';\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][0] = [...summessage[item][0]]\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][1] = [...summessage[item][1]]\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][2] = summessage[item][2];\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][0] = [...this.summsg[item][0], ...summessage[item][0]]\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][1] = [...this.summsg[item][1], ...summessage[item][1]]\n\t\t\t\t\t\t\t\t\t\t\t\tthis.summsg[item][2] = summessage[item][2];\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconsole.log(this.summsg, \"###################这是this.summsg############################\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar count = result.data.count;\n\t\t\t\t\t\t\t\t\tif (count == 0 && time >= 5000) {\n\t\t\t\t\t\t\t\t\t\ttime += (time < 10000) ? 500 : 0;\n\t\t\t\t\t\t\t\t\t\tif (time == 10000) {\n\t\t\t\t\t\t\t\t\t\t\ttime = 5000;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"##################11111\", time)\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttime = 5000;\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"##################\", time)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}, 10000)\n\t\t\t}\n\t\t},\n\t\tcreated() {\n\t\t\tthis.getsendmsg()\n\t\t}\n\t}\n</script>\n<style scoped>\n\t.content-title {\n\t\twidth: 100%;\n\t\theight: 60px;\n\t\tbackground: #c0c0c0;\n\t\tmargin-top: 10px;\n\t}\n\n\t.content-title>div {\n\t\twidth: 250px;\n\t\theight: 100%;\n\t\tfloat: left;\n\t}\n\n\t.content-title>div>img {\n\t\tmargin: 20px;\n\t\tfloat: left;\n\t\tmargin-left: 30px;\n\t}\n\n\t.content-title>div>p {\n\t\tfont-size: 26px;\n\t\tfont-weight: bold;\n\t\tfloat: left;\n\t\tpadding: 0;\n\t\tline-height: 60px;\n\t}\n\n\t.content-b {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tpadding-top: 10px;\n\t}\n\n\t.el-header {\n\t\tbackground-color: #ccc;\n\t\tcolor: #323232;\n\t\ttext-align: left;\n\t\tline-height: 60px;\n\t\tmargin: 10px 0 20px;\n\t\tfont-size: 26px;\n\t\tfont-weight: bold;\n\t\tfloat: left;\n\t\tpadding: 0;\n\t}\n\n\taside.el-aside {\n\t\twidth: 255px !important;\n\t}\n\n\t.el-aside {\n\t\tbackground-color: #cbe198;\n\t\tcolor: #333;\n\t\ttext-align: center;\n\t\tline-height: 200px;\n\t\twidth: 255px;\n\t\t/* height:430px; */\n\t\tmargin: 0 10px;\n\t}\n\n\t.el-main {\n\t\tbackground-color: #cbe198;\n\t\tcolor: #333;\n\t\tposition: relative;\n\t\ttext-align: center;\n\t\tline-height: 160px;\n\t}\n\n\t.el-header>div>img {\n\t\tmargin: 20px;\n\t\tfloat: left;\n\t\tmargin-left: 30px;\n\t}\n\n\tmain.el-main {\n\t\tpadding: 0;\n\t}\n\n\t.chat-a,\n\t.chat-b,\n\t.chat-a>p {\n\t\twidth: 100%;\n\t\theight: 40px;\n\t\tbackground-color: #add597;\n\t\tfont-size: 20px;\n\t\tline-height: 40px;\n\t}\n\n\t.chat-b {\n\t\tposition: relative;\n\t}\n\n\t.chat-a>p {\n\t\t/* position: fixed;\n    top:0;left:0; */\n\t\tcolor: #fff;\n\t\t/* z-index: 2; */\n\t}\n\n\t.chat-b>p {\n\t\tcolor: #000;\n\t\tfont-size: 20px;\n\t}\n\n\t.chat-list,\n\t.chat-msg {\n\t\twidth: 100%;\n\t\t/* height: 385px; */\n\t\tmin-height: 385px;\n\t\t/* border: 1px solid rosybrown; */\n\t}\n\n\t/* .chat-list-a{\n    width:100%;height:70px;\n    background-color: #80c26a;\n    margin: 2px 0 10px;\n} */\n\t.chat-msg>.chat-msg-a,\n\t.chat-msg>.chat-msg-b {\n\t\twidth: 100%;\n\t\t/* height: 80px; */\n\t\t/* border:1px solid red; */\n\t\tmargin-top: 20px;\n\t}\n\n\t.chat-msg>.chat-msg-b {\n\t\tfloat: right;\n\t}\n\n\t.chat-msg>.chat-msg-b>img {\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tfloat: right;\n\t\tmargin: 15px;\n\t}\n\n\t.chat-msg-a>.msg-list {\n\t\tfloat: left;\n\t\twidth: 490px;\n\t\t/* height:80px; */\n\t\t/* border:1px solid #dae8ba; */\n\t\tmargin-top: 10px;\n\t\t/* border:1px solid red; */\n\t\tpadding: 0;\n\t}\n\n\t.back-img {\n\t\t/* width:150px; */\n\t\theight: 100%;\n\t\tfloat: left;\n\t\t/* background: url('../../public/images/chatleft.png') center center no-repeat; */\n\t\t/* background-position: center; */\n\t\tbackground-size: cover;\n\t\t-moz-background-size: cover;\n\t\tmargin-top: -20px;\n\t\tbackground: #f6f6f6;\n\t\tborder-radius: 5px;\n\t\t/* display: inline; */\n\t}\n\n\t.back-img-right {\n\t\tfloat: right;\n\t\t/* width:150px; */\n\t\theight: 100%;\n\t\t/* background: url('../../public/images/chatright.png') center center no-repeat; */\n\t\t/* background-size:100% 100%;  */\n\t\t/* background-position: center; */\n\t\tbackground-size: cover;\n\t\t-moz-background-size: cover;\n\t\tbackground: #f6f6f6;\n\t\tborder-radius: 5px;\n\t\t/* margin-top:-20px; */\n\t}\n\n\t.back-img>p,\n\t.back-img-right>p {\n\t\t/* border:1px solid yellowgreen; */\n\t\t/* height: 80px; */\n\t\tpadding: 0;\n\t\tline-height: 80px;\n\t\t/* padding-left:20px; */\n\t\tmax-width: 200px;\n\t\toverflow: hidden;\n\t}\n\n\t.back-img>p {\n\t\tpadding-left: 40px;\n\t\tpadding-right: 40px;\n\t}\n\n\t.back-img-right>p {\n\t\tpadding-right: 40px;\n\t\tpadding-left: 0px;\n\t}\n\n\t.chat-msg>.chat-msg-b>.msg-list {\n\t\tfloat: right;\n\t\twidth: 490px;\n\t\t/* height:80px; */\n\t\t/* border:1px solid #dae8ba; */\n\t\t/* margin:0 10px; */\n\t}\n\n\t.chat-msg-img {\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tfloat: left;\n\t\tmargin: 15px;\n\t\tborder-radius: 50%;\n\t\t/* border:1px solid fuchsia; */\n\t\t/* padding:0; */\n\t}\n\n\t.chat-msg-img-right {\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tfloat: right;\n\t\tmargin: 15px;\n\t\tborder-radius: 50%;\n\t\t/* border:1px solid fuchsia; */\n\t\t/* padding:0; */\n\t}\n\n\t.chat-msg-img>img,\n\t.chat-msg-img-right>img {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tborder-radius: 50%;\n\t\t/* padding:0; */\n\t\tline-height: 100%;\n\t\t/* border:1px solid greenyellow; */\n\t\tmargin-top: -115px;\n\t}\n\n\t.msg-input {\n\t\twidth: 100%;\n\t\theight: 150px;\n\t\t/* float:left; */\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\tbottom: 0;\n\t\t/* border:1px solid red; */\n\t\tbackground: #add597;\n\t\t/* position: relative; */\n\t\tmargin-bottom: 0px;\n\t}\n\n\t.m-input {\n\t\t/* width: 80%; */\n\t\theight: 70%;\n\t\t/* margin-left: 20px; */\n\t\t/* margin-top: 30px; */\n\t\tfloat: left;\n\t\tbackground: #ffffff;\n\t\tborder-radius: 5px;\n\t\tborder: 0;\n\t}\n\n\t.btn-success {\n\t\twidth: 80px;\n\t\theight: 40px;\n\t\tborder-radius: 10px;\n\t\tpadding: 0;\n\t\tline-height: 40px;\n\t\tmargin-top: -50px;\n\t}\n\n\t.el-container {\n\t\theight: 508px;\n\t\twidth: 100%;\n\t\tposition: relative;\n\t}\n</style>\n",null]}